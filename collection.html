<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bon Idee Collection | Bon Idee</title>
  <meta name="description" content="The Bon Idee Collection highlights Bon Idee dog owners, their dogs, and their accomplishments." />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <header class="nav">
    <div class="container nav-inner">
      <a class="brand" href="./">Bon Idee</a>

      <nav class="links">
        <a href="bouviers.html">Bouviers</a>
        <a href="lowchen.html">Lowchen</a>
        <a href="index.html#puppies">Puppies</a>
        <a href="index.html#health">Health</a>
        <a href="collection.html" aria-current="page">Bon Idee Collection</a>
        <a class="btn" href="#submit">Submit a Story</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="container hero-inner">
        <div class="hero-copy">
          <p class="kicker">Bon Idee Collection</p>
          <h1>The Bon Idee Collection</h1>
          <p class="lead">
            A curated showcase of Bon Idee dogs and the people behind them. Stories, milestones, and accomplishments.
          </p>

          <div class="hero-actions">
            <a class="btn" href="#spotlights">Featured Spotlights</a>
            <a class="btn ghost" href="#posts">Newest Posts</a>
            <a class="btn ghost" href="#submit">Submit a Story</a>
          </div>

          <div class="badges">
            <span class="badge">Owners</span>
            <span class="badge">Dogs</span>
            <span class="badge">Stories</span>
          </div>
        </div>

        <div class="hero-media">
          <div class="media placeholder" style="background-image:url('./images/collection-hero.jpg'); background-size:cover; background-position:center;">
            <span>Drop a hero photo at<br><strong>/images/collection-hero.jpg</strong></span>
          </div>
          <div class="media-caption">
            <p class="small muted">Collection page hero image.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="spotlights">
      <div class="container">
        <div class="section-head">
          <h2>Featured Spotlights</h2>
          <p class="muted">Approved highlights from the Bon Idee community.</p>
        </div>

        <div id="featuredSpotlights" class="grid"></div>
      </div>
    </section>

    <section class="section alt" id="posts">
      <div class="container">
        <div class="section-head">
          <h2>Newest Posts</h2>
          <p class="muted">Latest approved submissions appear first.</p>
        </div>

        <div id="collectionPosts" class="grid"></div>
      </div>
    </section>

    <section class="section" id="submit">
      <div class="container">
        <div class="section-head">
          <h2>Submit a Story</h2>
          <p class="muted">
            Share photos of your Bon Idee dog and a short testimony. Submissions are reviewed before publishing.
          </p>
        </div>

        <div class="panel">
          <h3>Send your submission</h3>
          <p class="small muted">
            Include 1 to 3 photos and a short story. We will review, approve, and feature it here.
          </p>

          <div class="hero-actions" style="margin-top: 14px;">
            <a class="btn" href="PASTE_YOUR_GOOGLE_FORM_LINK_HERE" target="_blank" rel="noopener">Submit Photos and Story</a>
            <a class="btn ghost" href="index.html#contact">Contact</a>
          </div>

          <p class="small muted" style="margin-top: 12px;">
            By submitting, you confirm you have permission to share these photos and allow Bon Idee to feature them on this site.
          </p>
        </div>
      </div>
    </section>

    <footer class="footer">
      <div class="container footer-inner">
        <p class="small muted">© <span id="year"></span> Bon Idee</p>
        <p class="small muted"><a class="muted" href="./">Back to Home</a></p>
      </div>
    </footer>
  </main>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();
  </script>

  <script>
    (function () {
      let cbCounter = 0;

      function escapeHtml(s) {
        return String(s || "")
          .replaceAll("&", "&amp;")
          .replaceAll("<", "&lt;")
          .replaceAll(">", "&gt;")
          .replaceAll('"', "&quot;")
          .replaceAll("'", "&#039;");
      }

      function truncate(s, n) {
        const t = String(s || "").trim();
        if (t.length <= n) return t;
        return t.slice(0, n).trim() + "...";
      }

      function renderEmpty(target, msg) {
        target.innerHTML = `<div class="panel"><p class="small muted">${escapeHtml(msg)}</p></div>`;
      }

      window.loadBonIdeeCollection = function ({ targetFeaturedId, targetPostsId, scriptUrl, limit = 50 }) {
        const featuredEl = document.getElementById(targetFeaturedId);
        const postsEl = document.getElementById(targetPostsId);
        if (!featuredEl || !postsEl) return;

        featuredEl.innerHTML = '<p class="muted">Loading...</p>';
        postsEl.innerHTML = '<p class="muted">Loading...</p>';

        const cbName = `__bonIdeeCollectionCB_${Date.now()}_${cbCounter++}`;
        window[cbName] = function (data) {
          try {
            if (!data || !data.ok) {
              renderEmpty(featuredEl, "No featured posts yet.");
              renderEmpty(postsEl, "No posts yet.");
              return;
            }

            const items = Array.isArray(data.items) ? data.items : [];

            const featured = items.filter(x => x.featured).slice(0, 6);
            const posts = items;

            if (!featured.length) renderEmpty(featuredEl, "No featured posts yet.");
            else featuredEl.innerHTML = featured.map(renderSpotlightCard).join("");

            if (!posts.length) renderEmpty(postsEl, "No posts yet.");
            else postsEl.innerHTML = posts.map(renderPostCard).join("");
          } finally {
            delete window[cbName];
            script.remove();
          }
        };

        const url = new URL(scriptUrl);
        url.searchParams.set("key", "collection");
        url.searchParams.set("limit", String(limit));
        url.searchParams.set("callback", cbName);

        const script = document.createElement("script");
        script.src = url.toString();
        script.async = true;
        script.onerror = () => {
          renderEmpty(featuredEl, "Failed to load featured posts.");
          renderEmpty(postsEl, "Failed to load posts.");
          delete window[cbName];
          script.remove();
        };

        document.body.appendChild(script);
      };

      function renderSpotlightCard(p) {
        const cover = p.cover && p.cover.thumb ? p.cover.thumb : "";
        const coverView = p.cover && p.cover.view ? p.cover.view : "#";
        const title = `${escapeHtml(p.owner)}${p.dog ? " + " + escapeHtml(p.dog) : ""}`;
        const meta = [p.breed, p.timestamp ? new Date(p.timestamp).toLocaleDateString() : ""].filter(Boolean).join(" • ");
        const story = truncate(p.story || "", 140);

        const media = cover
          ? `<a href="${coverView}" target="_blank" rel="noopener"><div class="card-media imgwrap"><img loading="lazy" src="${cover}" alt="Spotlight photo" /></div></a>`
          : `<div class="card-media placeholder"><span>Spotlight photo</span></div>`;

        return `
          <article class="card">
            ${media}
            <div class="card-body">
              <h3>${title || "Spotlight"}</h3>
              <p class="small muted">${escapeHtml(meta)}</p>
              <p class="small muted">${escapeHtml(story)}</p>
            </div>
          </article>
        `;
      }

      function renderPostCard(p) {
        const cover = p.cover && p.cover.thumb ? p.cover.thumb : "";
        const coverView = p.cover && p.cover.view ? p.cover.view : "#";
        const title = `${escapeHtml(p.dog || "Bon Idee Dog")}`;
        const metaLeft = escapeHtml(p.owner || "");
        const metaRight = p.timestamp ? new Date(p.timestamp).toLocaleDateString() : "";
        const meta = [metaLeft, escapeHtml(p.breed || ""), metaRight].filter(Boolean).join(" • ");

        const story = truncate(p.story || "", 260);

        const media = cover
          ? `<a href="${coverView}" target="_blank" rel="noopener"><div class="card-media imgwrap"><img loading="lazy" src="${cover}" alt="Post photo" /></div></a>`
          : `<div class="card-media placeholder"><span>Photo</span></div>`;

        return `
          <article class="card">
            ${media}
            <div class="card-body">
              <h3>${title}</h3>
              <p class="small muted">${meta}</p>
              <p class="small muted">${escapeHtml(story)}</p>
            </div>
          </article>
        `;
      }
    })();
  </script>

  <script>
    const APPS_SCRIPT_WEBAPP_URL = "https://script.google.com/macros/s/AKfycbzLj1H04WNOujMAeQWp6yG6Ne7ks_IY3ddE0SUwAabwsnFvWT1v_IbVuq08-FVIKIUfkQ/exec?v=3";

    loadBonIdeeCollection({
      targetFeaturedId: "featuredSpotlights",
      targetPostsId: "collectionPosts",
      scriptUrl: APPS_SCRIPT_WEBAPP_URL,
      limit: 80
    });
  </script>
</body>
</html>
